<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <title>Acta Administrativa – Primera Parte</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;line-height:1.4;padding:16px;max-width:850px;margin:auto}
    .bloque{white-space:pre-wrap;font-size:15px}
    .muted{color:#666;font-size:12px;margin-top:8px}
  </style>
</head>
<body>
  <h1>Acta Administrativa — Primer Párrafo</h1>
  <div id="salida" class="bloque">Cargando datos…</div>
  <div class="muted">Fuente: Direccion.json + datos.json</div>

<script>
(async function(){
  // URLs exactas que compartiste:
  const URL_DIRECCION = "https://raw.githubusercontent.com/alcnca/mapa-semaforo/refs/heads/main/Direccion.json";
  const URL_DATOS     = "https://raw.githubusercontent.com/alcnca/mapa-semaforo/refs/heads/main/datos.json";

  // Utilidad: número a texto (0–59) en español, para horas/minutos
  function numEnEsp(n){
    const unidades = ["cero","uno","dos","tres","cuatro","cinco","seis","siete","ocho","nueve","diez","once","doce","trece","catorce","quince",
                      "dieciséis","diecisiete","dieciocho","diecinueve","veinte","veintiuno","veintidós","veintitrés","veinticuatro","veinticinco",
                      "veintiséis","veintisiete","veintiocho","veintinueve"];
    if (n < 30) return unidades[n];
    const decenas = ["", "", "", "treinta", "cuarenta", "cincuenta"];
    const d = Math.floor(n/10), u = n%10;
    return u === 0 ? decenas[d] : `${decenas[d]} y ${unidades[u]}`;
  }
  // Utilidad: año en letras muy simple (2000–2099)
  function anioEnLetras(y){
    // y = 2025 → "dos mil veinticinco"
    const mapaAnios = {
      2000:"dos mil",2001:"dos mil uno",2002:"dos mil dos",2003:"dos mil tres",2004:"dos mil cuatro",2005:"dos mil cinco",
      2006:"dos mil seis",2007:"dos mil siete",2008:"dos mil ocho",2009:"dos mil nueve",
      2010:"dos mil diez",2011:"dos mil once",2012:"dos mil doce",2013:"dos mil trece",2014:"dos mil catorce",
      2015:"dos mil quince",2016:"dos mil dieciséis",2017:"dos mil diecisiete",2018:"dos mil dieciocho",2019:"dos mil diecinueve",
      2020:"dos mil veinte",2021:"dos mil veintiuno",2022:"dos mil veintidós",2023:"dos mil veintitrés",2024:"dos mil veinticuatro",
      2025:"dos mil veinticinco",2026:"dos mil veintiséis",2027:"dos mil veintisiete",2028:"dos mil veintiocho",2029:"dos mil veintinueve"
    };
    return mapaAnios[y] || y.toString();
  }
  // Utilidad: mes en español
  const meses = ["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"];

  // Hora/fecha actual en America/Cancun (sin DST)
  function fechaActualEnLetras(){
    try{
      const ahora = new Date();
      // Forzamos zona declarando opciones de formato; texto final lo componemos nosotros
      const opts = { timeZone: "America/Cancun", hour12: false };
      const fmt = new Intl.DateTimeFormat("es-MX", {
        ...opts, year: "numeric", month: "numeric", day: "numeric", hour: "2-digit", minute:"2-digit"
      }).formatToParts(ahora).reduce((acc,p)=>{acc[p.type]=p.value;return acc;},{});
      const h = parseInt(fmt.hour,10);
      const m = parseInt(fmt.minute,10);
      // Re-creamos fecha en esa zona con toLocaleString para extraer mes/día/año confiables
      const fechaMX = new Date(ahora.toLocaleString("en-US", { timeZone: "America/Cancun" }));
      const dia = fechaMX.getDate();
      const mes = fechaMX.getMonth(); // 0-11
      const anio = fechaMX.getFullYear();
      const hTxt = numEnEsp(h);
      const mTxt = m===0 ? "cero" : numEnEsp(m);
      const diaTxt = numEnEsp(dia);
      const mesTxt = meses[mes];
      const anioTxt = anioEnLetras(anio);
      // “diecisiete horas con dieciséis minutos del dieciocho de septiembre de dos mil veinticinco”
      return `${hTxt} horas con ${mTxt} minutos del ${diaTxt} de ${mesTxt} de ${anioTxt}`;
    }catch(e){
      // Fallback simple
      return "____ horas con ____ minutos del ____ de ____ de ____";
    }
  }

  // Descarga segura de JSON
  async function getJSON(url){
    const r = await fetch(url, {cache:"no-store"});
    if(!r.ok) throw new Error("No se pudo cargar: "+url);
    return r.json();
  }

  let dir = {}, datos = {};
  try{
    [dir, datos] = await Promise.all([
      getJSON(URL_DIRECCION),
      getJSON(URL_DATOS)
    ]);
  }catch(e){
    document.getElementById("salida").textContent =
      "Error al cargar los JSON. Verifica que las URLs estén accesibles.\n\n"+e;
    return;
  }

  // Extraemos campos (con fallback a cadena vacía)
  const MUNICIPIO       = (dir?.MUNICIPIO || "").toString().trim();
  const ESTADO          = (dir?.ESTADO || "").toString().trim().replace(/^\s+/, "");
  const NOMBRE_SUCURSAL = (dir?.Nombre_Sucursal || "").toString().trim();
  const DIRECCION       = (dir?.DIRECCION || "").toString().trim();
  const GERENTE         = (dir?.GERENTE || "").toString().trim();

  const COORDINADOR     = (datos?.coordinador || "").toString().trim();
  const EJECUTIVO       = (datos?.Ejecutivo   || "").toString().trim();

  const fechaLetras = fechaActualEnLetras();

  // Redactamos el párrafo exactamente como pediste:
  const parrafo = `En el Municipio de ${MUNICIPIO}, ${ESTADO}, en la sucursal de ${NOMBRE_SUCURSAL}, `+
  `siendo las ${fechaLetras}, estando presentes en las instalaciones de la COOPERATIVA ACREIMEX S.C. de A.P. de R.L. de C.V., `+
  `con domicilio en ${DIRECCION}, los ciudadanos ${COORDINADOR}, que ostenta el puesto de Coordinador de Recuperación y `+
  `${EJECUTIVO} con el puesto de asesor de créditos y recuperación individual. `+
  `Estando presentes en su carácter de testigos los ciudadanos ${GERENTE} que ostenta el puesto de Gerente de Sucursal y `+
  `Adan Gutierrez Hernandez con el puesto de Gerente de Recuperación Extrajudicial, a quienes les constan los hechos que dan origen al levantamiento de la presente acta.\n\n`+
  `A continuación, el ciudadano ${COORDINADOR}, narra a los comparecientes los hechos y las razones por las cuales se procede a levantar la presente acta administrativa que consiste en lo siguiente:`;

  document.getElementById("salida").textContent = parrafo;
})();
</script>
</body>
</html>
