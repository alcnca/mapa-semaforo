<script>
// --- NUEVO: normalizar nombres de claves y obtener por clave flexible ---
function normKey(s){
  return String(s ?? "")
    .normalize("NFD").replace(/[\u0300-\u036f]/g,"")   // sin acentos
    .replace(/[_\s]+/g," ")                            // _ y múltiples espacios => 1 espacio
    .trim().toUpperCase();
}
function getByNormKey(obj, target){
  const t = normKey(target);
  for (const k of Object.keys(obj || {})) {
    if (normKey(k) === t) return obj[k];
  }
  return "";
}

// --- Reemplaza tus funciones por estas ---
function getRealizoUltimaGestion(r){
  // intenta varias etiquetas comunes y, si no, cae al buscador por nombre normalizado
  return (
    r["Realizo Ultima Gestion"] ??
    r["Realizó Última Gestión"] ??
    r["Realizo_Ultima_Gestion"] ??
    r["REALIZO_ULTIMA_GESTION"] ??
    r["RealizoUltimaGestion"] ??
    r["Realizo última gestión"] ??
    r["Realizó ultima gestion"] ??
    r["Ultima Gestion Realizo"] ??
    r["Ultima_Gestion_Realizo"] ??
    getByNormKey(r, "Realizó Última Gestión") ??     // <- flexible
    getByNormKey(r, "Realizo Ultima Gestion") ??     // <- flexible
    ""
  );
}

function getTipoGestion(r){
  return (
    r["Tipo de Gestion"] ??
    r["Tipo_de_Gestion"] ??
    r["TIPO_DE_GESTION"] ??
    r["TipoGestion"] ??
    r["Tipo gestión"] ??
    r["Tipo de gestión"] ??
    r["GestionTipo"] ??
    getByNormKey(r, "Tipo de Gestión") ??            // <- flexible
    getByNormKey(r, "Tipo de Gestion") ??            // <- flexible
    ""
  );
}

// (opcional pero recomendado) Usa también la búsqueda flexible para Vencimiento:
function getFechaVencimientoRaw(r){
  return (
    r.Fecha_Vencimiento ??
    r["Fecha_Vencimiento"] ??
    r["Fecha de Vencimiento"] ??
    r["Fecha Vencimiento"] ??
    r["Vencimiento"] ??
    r["fecha_vencimiento"] ??
    getByNormKey(r, "Fecha Vencimiento") ??
    getByNormKey(r, "Fecha de Vencimiento") ??
    ""
  );
}
</script>
